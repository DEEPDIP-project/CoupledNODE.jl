<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · CoupledNODE.jl</title><meta name="title" content="Home · CoupledNODE.jl"/><meta property="og:title" content="Home · CoupledNODE.jl"/><meta property="twitter:title" content="Home · CoupledNODE.jl"/><meta name="description" content="Documentation for CoupledNODE.jl."/><meta property="og:description" content="Documentation for CoupledNODE.jl."/><meta property="twitter:description" content="Documentation for CoupledNODE.jl."/><meta property="og:url" content="https://DEEPDIP-project.github.io/CoupledNODE.jl/"/><meta property="twitter:url" content="https://DEEPDIP-project.github.io/CoupledNODE.jl/"/><link rel="canonical" href="https://DEEPDIP-project.github.io/CoupledNODE.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>CoupledNODE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/DEEPDIP-project/CoupledNODE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/DEEPDIP-project/CoupledNODE.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="CoupledNODE"><a class="docs-heading-anchor" href="#CoupledNODE">CoupledNODE</a><a id="CoupledNODE-1"></a><a class="docs-heading-anchor-permalink" href="#CoupledNODE" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/DEEPDIP-project/CoupledNODE.jl">CoupledNODE</a>.</p><ul><li><a href="#CoupledNODE.cnn-Tuple{}"><code>CoupledNODE.cnn</code></a></li><li><a href="#CoupledNODE.cpu_interpolate-Tuple{Any, Any, Any}"><code>CoupledNODE.cpu_interpolate</code></a></li><li><a href="#CoupledNODE.create_loss_post_lux-Tuple{Any}"><code>CoupledNODE.create_loss_post_lux</code></a></li><li><a href="#CoupledNODE.create_loss_priori-Tuple{Any, Any}"><code>CoupledNODE.create_loss_priori</code></a></li><li><a href="#CoupledNODE.create_randloss_MulDtO-Tuple{Any, Any, Any}"><code>CoupledNODE.create_randloss_MulDtO</code></a></li><li><a href="#CoupledNODE.create_randloss_derivative-NTuple{4, Any}"><code>CoupledNODE.create_randloss_derivative</code></a></li><li><a href="#CoupledNODE.decollocate"><code>CoupledNODE.decollocate</code></a></li><li><a href="#CoupledNODE.load_checkpoint-Tuple{Any}"><code>CoupledNODE.load_checkpoint</code></a></li><li><a href="#CoupledNODE.loss_MulDtO_oneset-NTuple{4, Any}"><code>CoupledNODE.loss_MulDtO_oneset</code></a></li><li><a href="#CoupledNODE.loss_posteriori_optim-NTuple{4, Any}"><code>CoupledNODE.loss_posteriori_optim</code></a></li><li><a href="#CoupledNODE.loss_priori_lux"><code>CoupledNODE.loss_priori_lux</code></a></li><li><a href="#CoupledNODE.mean_squared_error-NTuple{4, Any}"><code>CoupledNODE.mean_squared_error</code></a></li><li><a href="#CoupledNODE.mean_squared_error-NTuple{7, Any}"><code>CoupledNODE.mean_squared_error</code></a></li><li><a href="#CoupledNODE.validate_results"><code>CoupledNODE.validate_results</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CoupledNODE.cnn-Tuple{}" href="#CoupledNODE.cnn-Tuple{}"><code>CoupledNODE.cnn</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cnn(; setup, radii, channels, activations, use_bias, channel_augmenter = identity, rng = Random.default_rng())</code></pre><p>Constructs a convolutional neural network model <code>closure(u, θ)</code> that predicts the commutator error (i.e. closure).</p><p><strong>Arguments</strong></p><ul><li><code>setup</code>: IncompressibleNavierStokes.jl setup</li><li><code>radii</code>: An array (size n_layers) with the radii of the kernels for the convolutional layers. Kernels will be symmetrical of size <code>2r+1</code>.</li><li><code>channels</code>: An array (size n_layers) with channel sizes for the convolutional layers.</li><li><code>activations</code>: An array (size n_layers) with activation functions for the convolutional layers.</li><li><code>use_bias</code>: An array (size n_layers) with booleans indicating whether to use bias in each convolutional layer.</li><li><code>rng</code>: A random number generator (default: <code>Random.default_rng()</code>).</li></ul><p><strong>Returns</strong></p><p>A tuple <code>(chain, params, state)</code> where</p><ul><li><code>chain</code>: The constructed Lux.Chain model.</li><li><code>params</code>: The parameters of the model.</li><li><code>state</code>: The state of the model.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DEEPDIP-project/CoupledNODE.jl/blob/813daf54fdc8a331dd4b0073ba28fbe6f9cf6311/src/models/cnn.jl#L6-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CoupledNODE.cpu_interpolate-Tuple{Any, Any, Any}" href="#CoupledNODE.cpu_interpolate-Tuple{Any, Any, Any}"><code>CoupledNODE.cpu_interpolate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Interpolate velocity components to volume centers.</p><p>TODO, D and dir can be parameters istead of arguments I think</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DEEPDIP-project/CoupledNODE.jl/blob/813daf54fdc8a331dd4b0073ba28fbe6f9cf6311/src/models/cnn.jl#L77-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CoupledNODE.create_loss_post_lux-Tuple{Any}" href="#CoupledNODE.create_loss_post_lux-Tuple{Any}"><code>CoupledNODE.create_loss_post_lux</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_loss_post_lux(rhs; sciml_solver = Tsit5(), kwargs...)</code></pre><p>Creates a loss function for a-posteriori fitting using the given right-hand side (RHS) function <code>rhs</code>. The loss function computes the sum of squared differences between the predicted values and the actual data,  normalized by the sum of squared actual data values.</p><p><strong>Arguments</strong></p><ul><li><code>rhs::Function</code>: The right-hand side function for the ODE problem.</li><li><code>sciml_solver::AbstractODEAlgorithm</code>: (Optional) The SciML solver to use for solving the ODE problem. Defaults to <code>Tsit5()</code>.</li><li><code>kwargs...</code>: Additional keyword arguments to pass to the solver.</li></ul><p><strong>Returns</strong></p><ul><li><code>loss_function::Function</code>: A function that computes the loss given a model, parameters, state, and data <code>(u, t)</code>.</li></ul><p><strong><code>loss_function</code> Arguments</strong></p><ul><li><code>model</code>: The model to evaluate.</li><li><code>ps</code>: Parameters for the model.</li><li><code>st</code>: State of the model.</li><li><code>(u, t)</code>: Tuple containing the data <code>u</code> and time points <code>t</code>.</li></ul><p><strong><code>loss_function</code> Returns</strong></p><ul><li><code>loss</code>: The computed loss value.</li><li><code>st</code>: The model state (unchanged).</li><li><code>metadata::NamedTuple</code>: A named tuple containing the predicted values <code>y_pred</code>.</li></ul><p>This makes it compatible with the Lux ecosystem.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DEEPDIP-project/CoupledNODE.jl/blob/813daf54fdc8a331dd4b0073ba28fbe6f9cf6311/src/loss/loss_posteriori.jl#L132-L158">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CoupledNODE.create_loss_priori-Tuple{Any, Any}" href="#CoupledNODE.create_loss_priori-Tuple{Any, Any}"><code>CoupledNODE.create_loss_priori</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Wrap loss function <code>loss(batch, θ)</code>.</p><p>The function <code>loss</code> should take inputs like <code>loss(f, x, y, θ)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DEEPDIP-project/CoupledNODE.jl/blob/813daf54fdc8a331dd4b0073ba28fbe6f9cf6311/src/loss/loss_priori.jl#L100-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CoupledNODE.create_randloss_MulDtO-Tuple{Any, Any, Any}" href="#CoupledNODE.create_randloss_MulDtO-Tuple{Any, Any, Any}"><code>CoupledNODE.create_randloss_MulDtO</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>[DEPRECATED]     create<em>randloss</em>MulDtO(target; nunroll, nintervals=1, nsamples, λ<em>c, λ</em>l1)</p><p>Creates a random loss function for the multishooting method with multiple shooting intervals.</p><p><strong>Arguments</strong></p><ul><li><code>target</code>: The target data for the loss function.</li><li><code>training_CNODE</code>: Model CNODE.</li><li><code>st</code>: state of the neural part.</li><li><code>nunroll</code>: The number of time steps to unroll.</li><li><code>noverlaps</code>: The number of time steps that overlaps between consecutive intervals.</li><li><code>nintervals</code>: The number of shooting intervals.</li><li><code>nsamples</code>: The number of samples to select.</li><li><code>λ_c</code>: The weight for the continuity term. It sets how strongly we make the pieces match (continuity term).</li><li><code>λ_l1</code>: The coefficient for the L1 regularization term in the loss function.</li></ul><p><strong>Returns</strong></p><ul><li><code>randloss_MulDtO</code>: A random loss function for the multishooting method.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DEEPDIP-project/CoupledNODE.jl/blob/813daf54fdc8a331dd4b0073ba28fbe6f9cf6311/src/loss/loss_posteriori.jl#L7-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CoupledNODE.create_randloss_derivative-NTuple{4, Any}" href="#CoupledNODE.create_randloss_derivative-NTuple{4, Any}"><code>CoupledNODE.create_randloss_derivative</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_randloss_derivative(input_data, F_target, f, st; n_use = size(input_data, 2), λ=0, λ_c = 0)</code></pre><p>Create a randomized loss function that compares the derivatives. This is done because using the entire dataset at each iteration would be too expensive.</p><p><strong>Arguments</strong></p><ul><li><code>input_data</code>: The input data.</li><li><code>F_target</code>: The target data.</li><li><code>f</code>: The model function.</li><li><code>st</code>: The model state.</li><li><code>n_use</code>: The number of samples to use for the loss function. Defaults to the number of samples in the input data.</li><li><code>λ</code> and <code>λ_c</code>: The regularization parameter. Defaults to 0.</li></ul><p><strong>Returns</strong></p><p>A function that computes the mean squared error loss and takes as input the model parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DEEPDIP-project/CoupledNODE.jl/blob/813daf54fdc8a331dd4b0073ba28fbe6f9cf6311/src/loss/loss_priori.jl#L52-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CoupledNODE.decollocate" href="#CoupledNODE.decollocate"><code>CoupledNODE.decollocate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Interpolate closure force from volume centers to volume faces.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DEEPDIP-project/CoupledNODE.jl/blob/813daf54fdc8a331dd4b0073ba28fbe6f9cf6311/src/models/cnn.jl#L99-L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CoupledNODE.load_checkpoint-Tuple{Any}" href="#CoupledNODE.load_checkpoint-Tuple{Any}"><code>CoupledNODE.load_checkpoint</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_checkpoint(checkfile)</code></pre><p>Load a training checkpoint from the specified file.</p><p><strong>Arguments</strong></p><ul><li><code>checkfile::String</code>: The path to the checkpoint file.</li></ul><p><strong>Returns</strong></p><ul><li><code>callbackstate</code>: The state of the callback at the checkpoint.</li><li><code>trainstate</code>: The state of the training process at the checkpoint.</li><li><code>epochs_trained::Int</code>: The number of epochs completed at the checkpoint.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">callbackstate, trainstate, epochs_trained = load_checkpoint(&quot;checkpoint.jld2&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DEEPDIP-project/CoupledNODE.jl/blob/813daf54fdc8a331dd4b0073ba28fbe6f9cf6311/src/checkpoints.jl#L3-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CoupledNODE.loss_MulDtO_oneset-NTuple{4, Any}" href="#CoupledNODE.loss_MulDtO_oneset-NTuple{4, Any}"><code>CoupledNODE.loss_MulDtO_oneset</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>[DEPRECATED]     loss<em>MulDtO</em>oneset(trajectory, θ; λ<em>c=1e1, λ</em>l1=1e1, nunroll, nintervals, nsamples=nsamples)</p><p>Compute the loss function for the multiple shooting method with a continuous neural ODE (CNODE) model. Check https://docs.sciml.ai/DiffEqFlux/dev/examples/multiple_shooting/ for more details.</p><p><strong>Arguments</strong></p><ul><li><code>trajectory</code>: The trajectory of the system.</li><li><code>θ</code>: The parameters of the CNODE model.</li><li><code>training_CNODE</code>: Model CNODE.</li><li><code>λ_c</code>: The weight for the continuity term. It sets how strongly we make the pieces match (continuity term). Default is <code>1e1</code>.</li><li><code>λ_l1</code>: The weight for the L1 regularization term. Default is <code>1e1</code>.</li><li><code>nunroll</code>: The number of time steps to unroll the trajectory.</li><li><code>noverlaps</code>: The number of time steps that overlaps between each consecutive intervals.</li><li><code>nintervals</code>: The number of intervals to divide the trajectory into.</li><li><code>nsamples</code>: The number of samples.</li></ul><p><strong>Returns</strong></p><ul><li><code>loss</code>: The computed loss value.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DEEPDIP-project/CoupledNODE.jl/blob/813daf54fdc8a331dd4b0073ba28fbe6f9cf6311/src/loss/loss_posteriori.jl#L59-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CoupledNODE.loss_posteriori_optim-NTuple{4, Any}" href="#CoupledNODE.loss_posteriori_optim-NTuple{4, Any}"><code>CoupledNODE.loss_posteriori_optim</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">loss_posteriori_optim(model, p, st, dataloader)</code></pre><p>Compute the loss function for a-posteriori fitting using the given model, parameters, state, and dataloader. This function is compatible with training via Optim.jl.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: The model to evaluate.</li><li><code>p</code>: Parameters for the model.</li><li><code>st</code>: State of the model.</li><li><code>dataloader::Function</code>: A function that returns the data <code>(u, t)</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>loss</code>: The computed loss value.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DEEPDIP-project/CoupledNODE.jl/blob/813daf54fdc8a331dd4b0073ba28fbe6f9cf6311/src/loss/loss_posteriori.jl#L205-L219">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CoupledNODE.loss_priori_lux" href="#CoupledNODE.loss_priori_lux"><code>CoupledNODE.loss_priori_lux</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">loss_priori_lux(model, ps, st, (x, y))</code></pre><p>Compute the loss  as the sum of squared differences between the predicted values and the target values, normalized by the sum of squared target values. Format of function signature and outputs are compatible with the Lux ecosystem.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: The model to be evaluated.</li><li><code>ps</code>: Parameters for the model.</li><li><code>st</code>: State of the model.</li><li><code>(x, y)</code>: A tuple where <code>x</code> is the input data and <code>y</code> is the target data.</li></ul><p><strong>Returns</strong></p><ul><li><code>loss</code>: The computed loss value.</li><li><code>st_</code>: The updated state of the model.</li><li><code>(; y_pred = y_pred)</code>: Named tuple containing the predicted values <code>y_pred</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DEEPDIP-project/CoupledNODE.jl/blob/813daf54fdc8a331dd4b0073ba28fbe6f9cf6311/src/loss/loss_priori.jl#L117-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CoupledNODE.mean_squared_error-NTuple{4, Any}" href="#CoupledNODE.mean_squared_error-NTuple{4, Any}"><code>CoupledNODE.mean_squared_error</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute MSE between <code>f(x, θ, st)</code> and <code>y</code>. The MSE is further divided by <code>normalize(y)</code>. This signature has been chosen for compatibility with Lux.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DEEPDIP-project/CoupledNODE.jl/blob/813daf54fdc8a331dd4b0073ba28fbe6f9cf6311/src/loss/loss_priori.jl#L107-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CoupledNODE.mean_squared_error-NTuple{7, Any}" href="#CoupledNODE.mean_squared_error-NTuple{7, Any}"><code>CoupledNODE.mean_squared_error</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mean_squared_error(f, st, x, y, θ, λ)</code></pre><p>Random a priori loss function. Use this function to train the closure term to reproduce the right hand side.</p><p><strong>Arguments:</strong></p><ul><li><code>f</code>: Function that represents the model.</li><li><code>st</code>: State of the model.</li><li><code>x</code>: Input data.</li><li><code>y</code>: Target data.</li><li><code>θ</code>: Parameters of the model.</li><li><code>λ</code> and <code>λ_c</code>: Regularization parameters.</li></ul><p><strong>Returns:</strong></p><ul><li><code>total_loss</code>: Mean squared error loss.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DEEPDIP-project/CoupledNODE.jl/blob/813daf54fdc8a331dd4b0073ba28fbe6f9cf6311/src/loss/loss_priori.jl#L10-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CoupledNODE.validate_results" href="#CoupledNODE.validate_results"><code>CoupledNODE.validate_results</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">validate_results(model, p, dataloader, nuse = 100)</code></pre><p>Validate the results of the model using the given parameters <code>p</code>, dataloader, and number of samples <code>nuse</code>.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: The model to evaluate.</li><li><code>p</code>: Parameters for the model.</li><li><code>dataloader::Function</code>: A function that returns the data <code>(u, t)</code>.</li><li><code>nuse::Int</code>: The number of samples to use for validation. Defaults to <code>100</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>loss</code>: The computed loss value.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DEEPDIP-project/CoupledNODE.jl/blob/813daf54fdc8a331dd4b0073ba28fbe6f9cf6311/src/loss/loss_posteriori.jl#L238-L251">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 7 February 2025 15:51">Friday 7 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
